<!--
    This is a webpage that's divided in 3 sections

    - On the center section, there is a monaco editor that will have a function template with some parameters
    - On the left section, there is a list of inputs that will be used as the parameters of function in the editor.
        There's a button to add a new parameter (input), each parameter can be removed,
        and the function template will be updated accordingly
    - On the right section, it will be shown the result of the function

    The function (the editor's inner text) is going to be evaluated every time any input changes,
    and the result shown in the right section
-->

<html>
    <head>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.19.0/min/vs/loader.js"></script>
        <script>
            let editor;
            // Load monaco
            require.config({ paths: { 'vs': 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.19.0/min/vs' } });
            require(['vs/editor/editor.main'], function () {
                // Initialize the editor
                editor = monaco.editor.create(document.getElementById('editor'), {
                    value: '(a, b) => a + b',
                    language: 'javascript',
                    theme: 'vs-dark'
                });
                // Update the function when the editor changes
                editor.onDidChangeModelContent(evaluate);
                evaluate()
            });
        </script>
        <style>
            body {
                width: 100vw;
                min-width: 300px;
                height: 100vh;
                margin: 0;
            }
            #container {
                box-sizing: border-box;
                display: flex;
                flex-wrap: wrap;
                gap: 1em;
                width: 100%;
                height: 100%;
                padding: 2em;
            }
            #editor {
                flex-basis: 300px;
                flex-grow: 1;
            }
            #inputs, #result {
                flex-basis: 100px;
                flex-grow: 1;
            }
            .input {
                display: flex;
            }
        </style>
    </head>
    <body>
        <div id="container">
            <div id="inputs">
                <button id="addInput">Add input</button>
                <div id="inputsList">
                    <div class="input">
                        <input type="text" id="input1" placeholder="Input 1"/>
                        <button onclick="document.getElementById('input1').parentElement.remove()">x</button>
                    </div>
                    <div class="input">
                        <input type="text" id="input2" placeholder="Input 2"/>
                        <button onclick="document.getElementById('input2').parentElement.remove()">x</button>
                    </div>
                </div>
            </div>
            <div id="editor"></div>
            <div id="result"></div>
            <script>
                const inputs = document.getElementById('inputs');
                const inputsList = document.getElementById('inputsList');
                const result = document.getElementById('result');

                // Add input
                const addInput = document.getElementById('addInput');
                addInput.addEventListener('click', () => {
                    const i = inputsList.children.length + 1;
                    const input = document.createElement('input');
                    input.type = 'text';
                    input.placeholder = 'Input ' + i;
                    input.id = 'input' + i;
                    input.addEventListener('input', evaluate);
                    const button = document.createElement('button');
                    button.innerText = "x"
                    const div = document.createElement('div');
                    button.addEventListener('click', ()=>div.remove());
                    div.class = "input"
                    div.appendChild(input);
                    div.appendChild(button);
                    inputsList.appendChild(div);
                });

                // Evaluate the function
                function evaluate () {
                    const functionText = editor.getValue();
                    const inputsText = [];
                    for (divInput of inputsList.children){
                        const input = divInput.firstElementChild;
                        inputsText.push(input.value);
                    };
                    console.log(functionText, inputsText);
                    result.innerText = eval(functionText)(...inputsText);
                };
                for (divInput of inputsList.children){
                    const input = divInput.firstElementChild;
                    input.addEventListener('input', evaluate);
                };
            </script>
        </div>
    </body>
</html>